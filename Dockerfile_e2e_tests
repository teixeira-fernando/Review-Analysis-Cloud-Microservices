# Use the official Gradle image with JDK 21 and Gradle 8.11.1
FROM gradle:8.11.1-jdk21

# Install Docker CLI
RUN apt-get update && apt-get install -y docker.io

# Set the working directory
WORKDIR /app

# Copy the Gradle wrapper and build files
COPY gradlew /app/
COPY gradle /app/gradle
COPY settings.gradle /app/

# Copy the specific e2e-tests module
COPY e2e-tests /app/e2e-tests

# Ensure Gradle wrapper is executable
RUN chmod +x /app/gradlew

# Run the tests for the e2e-tests module
CMD ["./gradlew", ":e2e-tests:test"]